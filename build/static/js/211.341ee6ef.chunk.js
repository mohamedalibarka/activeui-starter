(self.webpackChunk_activeviam_activeui=self.webpackChunk_activeviam_activeui||[]).push([[211],{45211:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var n=s(99046),a=s(21127),l=s.n(a),c=s(88517),o=s(58527),i=s.n(o),r=s(98537),u=s.n(r),d=s(2689),m=s.n(d),p=s(13224),b=s(83541);const h=e=>{const t=[];return e.forEach((e=>{const s=e.name;t.includes(s)||(e.showlegend=!0,t.push(s))})),e};function y({cube:e,data:t,metaData:s,widgetState:{mapping:n}}){if(!e||!t||!s)return[];const a={},l={},o={mapping:{},numberOfUsedAutomaticColors:0},{attributesRedirection:i}=s;const r=({membersPerAttribute:e,pointKey:t,traceKey:n})=>(l[n]||(l[n]=function({traceKey:e,membersPerAttribute:t}){const n=(0,c.Ym)(t.color,0),a=Object.values(l).some((e=>e.name===n)),i=(0,c.he)({accumulator:o,colorway:s.colorway,traceName:n});return{_key:e,hoverinfo:"none",legendgroup:n,mode:"markers",name:n,cellsIndices:[],showlegend:!a,text:[],textposition:"top center",type:"scatter",marker:{size:[],color:i},x:[],y:[],opacity:1}}({traceKey:n,membersPerAttribute:e})),u()(a,{[n]:{[t]:{}}}),a[n][t]),d=n.size.length>0;let b=0;const y=n.horizontalSubplots.length+n.verticalSubplots.length>0;(0,p.IG)(t,s.hierarchyIndicesInCellSet,(({cell:e,cellIndex:t,columnIndex:a,tuple:l,rowIndex:o})=>{if(l){const u=(0,c._F)(l,{levelIndices:s.levelIndicesPerField,mapping:n,attributesRedirection:i}),d=[...u.color,...u.horizontalSubplots,...u.verticalSubplots],m=u.splitBy,p=(0,c.Lj)(d),h=(0,c.Lj)(m),y=r({membersPerAttribute:u,traceKey:p,pointKey:h});if(y.cellsIndices||(y.cellsIndices=[]),null!==t&&y.cellsIndices.push({rowIndex:o,columnIndex:a,cellIndex:t}),e){const t=e.value;if(u.xValues.length>0)y.x=t;else if(u.yValues.length>0)y.y=t;else if(u.size.length>0){const e=Math.abs(t);y.size=e,e>b&&(b=e)}u.splitBy.length>0&&(y.text=(0,c.KT)(u.splitBy))}}})),Object.entries(l).forEach((([e,t])=>{const s=a[e];d||(t.marker.size=15),Object.values(s).forEach((e=>{const{cellsIndices:s,x:n,y:a,size:l,text:c}=e;t.cellsIndices.push(s),t.x.push(n),t.y.push(a),t.text.push(c),d&&t.marker.size.push(100*l/b)}))}));const g=Object.values(l);if(g.forEach((e=>{var t;e.axisIndices=m()(null===(t=e.x)||void 0===t?void 0:t.length)})),y){const e=s.subplots,t=(0,c.$)({traces:g,subplotsMetaData:e});return(0,c.Mr)(t,e),h(t),t}return h(g),g}const g=(0,c.dC)((0,c.i)((0,c.H9)((0,a.memo)((e=>{const{cube:t,data:s,metaData:o,widgetState:r,onLoaded:u}=e,d=(0,a.useMemo)((()=>(0,n.TS)(null==r?void 0:r.mapping)),[null==r?void 0:r.mapping]);(0,c.ge)({isEmpty:d,onLoaded:u});const m=(0,a.useMemo)((()=>y({cube:t,data:s,metaData:o,widgetState:r})),[t,s,o,r]),p=(0,a.useMemo)((()=>(e=>e?(0,b.IM)(c.bR,(0,c.S5)(e.subplots),(0,c.lH)(e.subplots)):{})(o)),[o]);return t&&s&&o&&!d?l().createElement(c.XN,i()({},e,{traces:m,layout:p,cube:t,data:s,metaData:o})):l().createElement(c.MQ,null)})))))}}]);